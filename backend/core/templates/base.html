{% load static %}
<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="utf-8">
    <title>{% block title %}ExamSite{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* nền toàn trang, ảnh fill màn hình */
        body::before {
            content: "";
            position: fixed;
            inset: 0;
            background: url("{% static 'pics/bk3.jpg' %}") center/cover no-repeat fixed;
            z-index: -2;
        }

        /* lớp phủ mờ nhẹ để chữ dễ đọc */
        body::after {
            content: "";
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.15);
            z-index: -1;
        }

        /* hiệu ứng glass */
        .glass {
            background: rgba(255, 255, 255, 0.18);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.25);
        }
    </style>
    {% block head_extra %}{% endblock %}
</head>

<body class="min-h-screen text-white">
    <!-- NAVBAR -->
    <nav class="glass fixed top-0 left-0 right-0 z-50">
        <div class="mx-auto max-w-7xl px-4">
            <div class="flex h-14 items-center justify-between">
                <a href="/" class="flex items-center gap-2">
                    <img src="{% static 'pics/logoFPT.png' %}" alt="FPT Logo" class="h-7 w-auto">
                </a>
                <div class="flex items-center gap-1">
                    {% with p=request.path %}

                    <!-- MENU DESKTOP (>= md): hiện đầy đủ các mục -->
                    <div class="hidden md:flex items-center gap-1">
                        <a href="/score" class="px-3 py-2 rounded-xl hover:bg-white/10 transition
                        {% if p|slice:':7' == '/score/' or p == '/score' %} bg-white/10 {% endif %}">Chấm điểm</a>
                        <a href="/organize" class="px-3 py-2 rounded-xl hover:bg-white/10 transition
                        {% if p|slice:':9' == '/organize' %} bg-white/10 {% endif %}">Tạo cuộc thi</a>
                        <a href="/ranking" class="px-3 py-2 rounded-xl hover:bg-white/10 transition
                        {% if p|slice:':9' == '/ranking' %} bg-white/10 {% endif %}">Xếp hạng</a>
                        <a href="/manage" class="px-3 py-2 rounded-xl hover:bg-white/10 transition
                        {% if p|slice:':7' == '/manage' %} bg-white/10 {% endif %}">Quản lý</a>

                        {% if request.session.judge_email %}
                        <span class="ml-2 px-3 py-2 rounded-xl bg-white/10">{{ request.session.judge_email }}</span>
                        <a href="/logout" class="ml-1 px-3 py-2 rounded-xl hover:bg-white/10 transition">Đăng xuất</a>
                        {% else %}
                        <a href="/login" class="ml-2 px-3 py-2 rounded-xl hover:bg-white/10 transition">Đăng nhập</a>
                        {% endif %}
                    </div>

                    <!-- MENU MOBILE (< md): chỉ hiện pill tài khoản; các mục nằm trong dropdown -->
                    <div class="md:hidden relative">
                        {% if request.session.judge_email %}
                        <button id="navUserBtn" type="button"
                                class="px-3 py-2 rounded-xl bg-white/10 flex items-center gap-2">
                            <span class="truncate max-w-[160px]">{{ request.session.judge_email }}</span>
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z" clip-rule="evenodd" />
                            </svg>
                        </button>
                        <div id="navDropdown"
                            class="hidden absolute right-0 mt-2 z-[60] min-w-[9.5rem] rounded-xl shadow-xl overflow-hidden bg-slate-900/85 ring-1 ring-white/15">
                            <a href="/score" class="block px-4 py-2 hover:bg-white/10">Chấm điểm</a>
                            <a href="/organize" class="block px-4 py-2 hover:bg-white/10">Tạo cuộc thi</a>
                            <a href="/ranking" class="block px-4 py-2 hover:bg-white/10">Xếp hạng</a>
                            <a href="/manage" class="block px-4 py-2 hover:bg-white/10">Quản lý</a>
                            <div class="h-px bg-white/20 my-1"></div>
                            <a href="/logout" class="block px-4 py-2 hover:bg-white/10">Đăng xuất</a>
                        </div>
                        {% else %}
                        <a href="/login" class="px-3 py-2 rounded-xl bg-white/10">Đăng nhập</a>
                        {% endif %}
                    </div>
                    {% endwith %}
                </div>
            </div>
        </div>
    </nav>

    <!-- CONTENT WRAPPER -->
    <main class="pt-16 pb-10">
        {% block content %}{% endblock %}
    </main>
    <script src="{% static 'core/navbar.js' %}?v={% now 'U' %}"></script>
</body>

</html>